from collections import deque


class Solution:
    def orangesRotting(self, grid: List[List[int]]) -> int:
        row=len(grid)
        col=len(grid[0])
        fresh=0
        q=deque()
        
        for i in range(row):
            for j in range(col):
                if grid[i][j]==1:
                    fresh+=1
                elif grid[i][j]==2:
                    q.append((i,j,0))

        ans=0

        # print(fresh)         
        while q:
            rooten=q.popleft()
            i,j,k=rooten[0],rooten[1],rooten[2]
            
            if i-1>=0 and grid[i-1][j]==1:
                grid[i-1][j]=2
                q.append((i-1,j,k+1))
                fresh-=1
                ans=max(ans,k+1)
                
            if i+1<row and grid[i+1][j]==1:
                grid[i+1][j]=2
                q.append((i+1,j,k+1))
                fresh-=1
                ans=max(ans,k+1)

                
            #for col
            if j-1>=0 and grid[i][j-1]==1:
                grid[i][j-1]=2
                q.append((i,j-1,k+1))
                fresh-=1
                ans=max(ans,k+1)

                
            if j+1<col and grid[i][j+1]==1:
                grid[i][j+1]=2
                q.append((i,j+1,k+1))
                fresh-=1
                ans=max(ans,k+1)

                
        if fresh:
            return -1

        return ans

        
        
# ðŸ“Œ à¦¬à¦¾à¦¸à§à¦¤à¦¬ à¦œà§€à¦¬à¦¨à§‡à¦° à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° (Real-World Applications of Rotting Oranges Problem)
# âœ… Problem: à¦à¦• à¦§à¦°à¦£à§‡à¦° BFS (Breadth-First Search) à¦¯à§‡à¦–à¦¾à¦¨à§‡ à¦à¦•à¦Ÿà¦¿ à¦…à¦¬à¦¸à§à¦¥à¦¾ à¦šà¦¾à¦°à¦¦à¦¿à¦•à§‡ à¦›à§œà¦¾à§Ÿ à¦ªà§à¦°à¦¤à¦¿ à¦‡à¦‰à¦¨à¦¿à¦Ÿ à¦Ÿà¦¾à¦‡à¦®à§‡à¥¤

# âœ… à§§. à¦°à§‹à¦— à¦›à§œà¦¾à¦¨à§‹ (Disease Spread Simulation)
# à¦‰à¦¦à¦¾à¦¹à¦°à¦£: à¦à¦•à¦Ÿà¦¿ à¦¶à¦¹à¦°à§‡ à¦à¦•à¦œà¦¨ à¦•à¦°à§‹à¦¨à¦¾ à¦°à§‹à¦—à§€ à¦†à¦›à§‡à¥¤ à¦¸à§‡ à¦ªà§à¦°à¦¤à¦¿à¦¦à¦¿à¦¨ à¦šà¦¾à¦°à¦ªà¦¾à¦¶à§‡à¦° à¦²à§‹à¦•à¦¦à§‡à¦° à¦¸à¦‚à¦•à§à¦°à¦®à¦¿à¦¤ à¦•à¦°à§‡à¥¤
# grid[i][j] = 1 â†’ à¦¸à§à¦¸à§à¦¥ à¦²à§‹à¦•, 2 â†’ à¦†à¦•à§à¦°à¦¾à¦¨à§à¦¤ à¦²à§‹à¦•
# à¦à¦‡ à¦…à§à¦¯à¦¾à¦²à¦—à¦°à¦¿à¦¦à¦® à¦¬à¦²à§‡ à¦•à¦¤à¦¦à¦¿à¦¨à§‡ à¦ªà§à¦°à§‹ à¦¶à¦¹à¦° à¦¸à¦‚à¦•à§à¦°à¦®à¦¿à¦¤ à¦¹à¦¬à§‡à¥¤
# à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦°: à¦•à¦°à§‹à¦¨à¦¾à¦° à¦®à¦¤à§‹ à¦®à¦¹à¦¾à¦®à¦¾à¦°à¦¿à¦° à¦¸à¦®à§Ÿ à¦¸à¦‚à¦•à§à¦°à¦®à¦£à§‡à¦° à¦—à¦¤à¦¿ à¦¨à¦¿à¦°à§à¦§à¦¾à¦°à¦£, à¦•à¦¨à§à¦Ÿà§‡à¦‡à¦¨à¦®à§‡à¦¨à§à¦Ÿ à¦œà§‹à¦¨ à¦¤à§ˆà¦°à¦¿à¥¤

# âœ… à§¨. à¦†à¦—à§à¦¨ à¦›à§œà¦¾à¦¨à§‹ (Forest Fire Simulation)
# à¦‰à¦¦à¦¾à¦¹à¦°à¦£: à¦à¦•à¦Ÿà¦¿ à¦—à¦¾à¦›à§‡ à¦†à¦—à§à¦¨ à¦§à¦°à§‡à¦›à§‡, à¦ªà§à¦°à¦¤à¦¿ à¦˜à¦¨à§à¦Ÿà¦¾à§Ÿ à¦¸à§‡à¦Ÿà¦¿ à¦ªà¦¾à¦¶à§‡à¦° à¦—à¦¾à¦›à§‡ à¦›à§œà¦¾à§Ÿà¥¤
# grid[i][j] = 1 â†’ à¦¶à§à¦•à¦¨à¦¾ à¦—à¦¾à¦›, 2 â†’ à¦œà§à¦¬à¦²à¦¨à§à¦¤ à¦—à¦¾à¦›
# à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦°: à¦«à¦¾à§Ÿà¦¾à¦° à¦«à¦¾à¦‡à¦Ÿà¦¾à¦°à¦¦à§‡à¦° à¦†à¦—à§à¦¨à§‡à¦° à¦›à§œà¦¿à§Ÿà§‡ à¦ªà§œà¦¾ à¦…à¦¨à§à¦®à¦¾à¦¨ à¦•à¦°à¦¾, à¦à¦­à¦¾à¦•à§à§Ÿà§‡à¦¶à¦¨ à¦ªà§à¦²à§à¦¯à¦¾à¦¨ à¦¤à§ˆà¦°à¦¿ à¦•à¦°à¦¾à¥¤

# âœ… à§©. à¦­à¦¾à¦‡à¦°à¦¾à¦¸ à¦›à§œà¦¾à¦¨à§‹ à¦•à¦®à§à¦ªà¦¿à¦‰à¦Ÿà¦¾à¦° à¦¨à§‡à¦Ÿà¦“à§Ÿà¦¾à¦°à§à¦•à§‡ (Network Virus Propagation)
# à¦‰à¦¦à¦¾à¦¹à¦°à¦£: à¦à¦•à¦Ÿà¦¿ à¦•à¦®à§à¦ªà¦¿à¦‰à¦Ÿà¦¾à¦° à¦­à¦¾à¦‡à¦°à¦¾à¦¸ à¦ªà¦¾à¦¶à§‡à¦° à¦¡à¦¿à¦­à¦¾à¦‡à¦¸à§‡ à¦›à§œà¦¾à§Ÿ à¦ªà§à¦°à¦¤à¦¿ à¦®à¦¿à¦¨à¦¿à¦Ÿà§‡à¥¤
# à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦°: à¦¸à¦¾à¦‡à¦¬à¦¾à¦° à¦†à¦•à§à¦°à¦®à¦£à§‡à¦° à¦—à¦¤à¦¿ à¦¬à§à¦à¦¾, à¦¨à¦¿à¦°à¦¾à¦ªà¦¤à§à¦¤à¦¾ à¦ªà¦°à¦¿à¦•à¦²à§à¦ªà¦¨à¦¾ à¦¬à¦¾à¦¨à¦¾à¦¨à§‹à¥¤

# âœ… à§ª. à¦ªà¦£à§à¦¯à§‡à¦° à¦¨à¦·à§à¦Ÿ à¦¹à¦“à§Ÿà¦¾ (Warehouse Spoilage)
# à¦‰à¦¦à¦¾à¦¹à¦°à¦£: à¦à¦•à¦Ÿà¦¿ à¦–à¦¾à¦¬à¦¾à¦° à¦ªà¦à¦šà§‡ à¦—à§‡à¦²à§‡ à¦¤à¦¾à¦° à¦ªà¦¾à¦¶à§‡ à¦¥à¦¾à¦•à¦¾ à¦¬à¦¾à¦•à§à¦¸à¦—à§à¦²à§‹à¦“ à¦¨à¦·à§à¦Ÿ à¦¹à§Ÿà§‡ à¦¯à¦¾à§Ÿà¥¤
# à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦°: à¦¸à§à¦Ÿà§‹à¦°à§‡ inventory spoilage model à¦•à¦°à¦¾, automation à¦à¦° à¦®à¦¾à¦§à§à¦¯à¦®à§‡ à¦¸à¦°à¦¾à¦¨à§‹à¥¤

# âœ… à§«. à¦¬à¦¨à§à¦¯à¦¾ à¦¬à¦¾ à¦¤à§‡à¦² à¦›à§œà¦¾à¦¨à§‹ (Flood/Oil Spill Simulation)
# à¦‰à¦¦à¦¾à¦¹à¦°à¦£: à¦à¦•à¦Ÿà¦¿ à¦˜à¦°à§‡ à¦ªà¦¾à¦¨à¦¿ à¦¢à§‹à¦•à§‡, à¦§à§€à¦°à§‡ à¦§à§€à¦°à§‡ à¦ªà¦¾à¦¶à§‡à¦° à¦˜à¦°à§‡ à¦¯à¦¾à§Ÿà¥¤
# à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦°: à¦¬à¦¨à§à¦¯à¦¾ à¦à¦²à¦¾à¦•à¦¾ à¦¨à¦¿à¦°à§à¦£à§Ÿ, cleaning robot-à¦à¦° à¦ªà¦¥ à¦¬à§‡à¦° à¦•à¦°à¦¾à¥¤

# âœ… à§¬. à¦•à§à¦²à¦¾à¦‰à¦¡ à¦¸à¦¾à¦°à§à¦­à¦¾à¦°à§‡ à¦¡à§‡à¦Ÿà¦¾ à¦›à§œà¦¾à¦¨à§‹ (Message Broadcasting in Systems)
# à¦‰à¦¦à¦¾à¦¹à¦°à¦£: à¦à¦•à¦Ÿà¦¿ à¦¸à¦¾à¦°à§à¦­à¦¾à¦° à¦ªà§à¦°à¦¤à¦¿ à¦¸à§‡à¦•à§‡à¦¨à§à¦¡à§‡ à¦ªà¦¾à¦¶à§‡à¦° à§ªà¦Ÿà¦¿ à¦¸à¦¾à¦°à§à¦­à¦¾à¦°à§‡ à¦¡à§‡à¦Ÿà¦¾ à¦ªà¦¾à¦ à¦¾à§Ÿà¥¤
# à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦°: distributed system design, latency à¦¨à¦¿à¦°à§à¦£à§Ÿà¥¤

# âœ… à¦¸à¦¾à¦°à¦¾à¦‚à¦¶:
# à¦¯à§‡ à¦•à§‹à¦¨ à¦¸à¦®à¦¸à§à¦¯à¦¾ à¦¯à§‡à¦–à¦¾à¦¨à§‡ "à¦à¦•à¦Ÿà¦¾ à¦˜à¦Ÿà¦¨à¦¾ à¦šà¦¾à¦°à¦ªà¦¾à¦¶à§‡ à¦›à§œà¦¾à§Ÿ à¦à¦• à¦§à¦¾à¦ªà§‡" â€” à¦¸à§‡à¦—à§à¦²à§‹à¦¤à§‡ à¦à¦‡ à¦Ÿà¦¾à¦‡à¦ª BFS à¦…à§à¦¯à¦¾à¦²à¦—à¦°à¦¿à¦¦à¦® à¦¬à¦¾à¦¸à§à¦¤à¦¬à§‡ à¦–à§à¦¬à¦‡ à¦¦à¦°à¦•à¦¾à¦°à¦¿à¥¤
